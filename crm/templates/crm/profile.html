{% extends "crm/base_crm.html" %}
{% load static %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - CRM –ê—Ä–≥—É—Å{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∞–≤–∞—Ç–∞—Ä–∫–æ–π (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è) -->
    <div class="mb-12">
        <div class="flex flex-col lg:flex-row items-center lg:items-end justify-between gap-8">
            <div class="flex items-center gap-6">
                <div class="relative group">
                    <div class="w-24 h-24 bg-gradient-to-br from-blue-500 to-purple-600 rounded-3xl flex items-center justify-center shadow-2xl border-4 border-white ring-4 ring-blue-100">
                        <img src="{% static 'images/profile-icon.svg' %}" alt="Profile" class="w-12 h-12 text-white" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <i data-lucide="user" class="w-12 h-12 text-white" style="display: none;"></i>
                    </div>
                    <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-green-500 rounded-full border-4 border-white flex items-center justify-center">
                        <i data-lucide="check" class="w-3 h-3 text-white"></i>
                    </div>
                </div>
                <div class="text-center lg:text-left">
                    <h1 class="text-4xl font-bold text-gray-900 mb-2">–ü—Ä–∏–≤–µ—Ç, {{ user.first_name|default:user.username }}! üëã</h1>
                    <p class="text-gray-600 text-lg mb-4">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å</p>
                    <div class="flex items-center gap-4 text-sm text-gray-500">
                        <div class="flex items-center gap-2">
                            <i data-lucide="shield" class="w-4 h-4"></i>
                            <span>{{ profile.get_role_display }}</span>
                        </div>
                        <div class="w-1 h-1 bg-gray-300 rounded-full"></div>
                        <div class="flex items-center gap-2">
                            <i data-lucide="calendar" class="w-4 h-4"></i>
                            <span>–° {{ user.date_joined|date:"d.m.Y" }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 xl:grid-cols-4 gap-6">
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="xl:col-span-3 space-y-6">
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-10 h-10 bg-gray-800 rounded-xl flex items-center justify-center">
                        <i data-lucide="user" class="w-5 h-5 text-white"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold text-gray-900">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                        <p class="text-gray-600 text-sm">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
                    <div class="space-y-3">
                        <div class="group p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-all duration-200">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                                    <i data-lucide="at-sign" class="w-4 h-4 text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="text-xs font-medium text-gray-500 mb-1">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                                    <div class="text-base font-semibold text-gray-900">{{ user.username }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="group p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-all duration-200">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                                    <i data-lucide="user" class="w-4 h-4 text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="text-xs font-medium text-gray-500 mb-1">–ò–º—è</div>
                                    <div class="text-base font-semibold text-gray-900">{{ user.first_name|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="group p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-all duration-200">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                                    <i data-lucide="mail" class="w-4 h-4 text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="text-xs font-medium text-gray-500 mb-1">Email</div>
                                    <div class="text-base font-semibold text-gray-900">{{ user.email|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
                    <div class="space-y-3">
                        <div class="group p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-all duration-200">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                                    <i data-lucide="shield" class="w-4 h-4 text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="text-xs font-medium text-gray-500 mb-1">–†–æ–ª—å –≤ —Å–∏—Å—Ç–µ–º–µ</div>
                                    <div class="text-base font-semibold text-gray-900">{{ profile.get_role_display }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="group p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-all duration-200">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                                    <i data-lucide="user-plus" class="w-4 h-4 text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="text-xs font-medium text-gray-500 mb-1">–§–∞–º–∏–ª–∏—è</div>
                                    <div class="text-base font-semibold text-gray-900">{{ user.last_name|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="group p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-all duration-200">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                                    <i data-lucide="phone" class="w-4 h-4 text-gray-700"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="text-xs font-medium text-gray-500 mb-1">–¢–µ–ª–µ—Ñ–æ–Ω</div>
                                    <div class="text-base font-semibold text-gray-900">{{ profile.phone|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-10 h-10 bg-gray-800 rounded-xl flex items-center justify-center">
                        <i data-lucide="edit-3" class="w-5 h-5 text-white"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold text-gray-900">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h2>
                        <p class="text-gray-600 text-sm">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</p>
                    </div>
                </div>
                
                <form method="POST" action="{% url 'crm_profile_update' %}" class="space-y-5">
                    {% csrf_token %}
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label for="first_name" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                <i data-lucide="user" class="w-3 h-3 text-gray-500"></i>
                                –ò–º—è
                            </label>
                            <input type="text" id="first_name" name="first_name" value="{{ user.first_name }}"
                                   class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 transition-all duration-200">
                        </div>
                        
                        <div class="space-y-2">
                            <label for="last_name" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                <i data-lucide="user-plus" class="w-3 h-3 text-gray-500"></i>
                                –§–∞–º–∏–ª–∏—è
                            </label>
                            <input type="text" id="last_name" name="last_name" value="{{ user.last_name }}"
                                   class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 transition-all duration-200">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label for="email" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                <i data-lucide="mail" class="w-3 h-3 text-gray-500"></i>
                                Email
                            </label>
                            <input type="email" id="email" name="email" value="{{ user.email }}"
                                   class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 transition-all duration-200">
                        </div>
                        
                        <div class="space-y-2">
                            <label for="phone" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                <i data-lucide="phone" class="w-3 h-3 text-gray-500"></i>
                                –¢–µ–ª–µ—Ñ–æ–Ω
                            </label>
                            <input type="text" id="phone" name="phone" value="{{ profile.phone|default:'' }}"
                                   class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 transition-all duration-200"
                                   placeholder="+7 (XXX) XXX-XX-XX">
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label for="corporate_email" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                            <i data-lucide="briefcase" class="w-3 h-3 text-gray-500"></i>
                            –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π Email
                        </label>
                        <input type="email" id="corporate_email" name="corporate_email" value="{{ profile.corporate_email|default:'' }}"
                               class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 transition-all duration-200"
                               placeholder="corporate@company.com">
                    </div>

                    <div class="flex gap-3 pt-4">
                        <button type="submit" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-semibold flex items-center gap-2 transition-all duration-200">
                            <i data-lucide="save" class="w-4 h-4"></i>
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        </button>
                        
                        <button type="button" onclick="showPasswordModal()"
                                class="border border-gray-300 text-gray-700 hover:bg-gray-50 px-6 py-2.5 rounded-lg font-semibold transition-all duration-200 flex items-center gap-2">
                            <i data-lucide="key" class="w-4 h-4"></i>
                            –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="space-y-5">
            <!-- –°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞ -->
            <div class="bg-white rounded-xl shadow-sm p-5 border border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <div class="w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center">
                        <i data-lucide="shield-check" class="w-4 h-4 text-white"></i>
                    </div>
                    –°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞
                </h2>
                
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-200">
                        <span class="text-gray-900 text-sm font-medium">–°—Ç–∞—Ç—É—Å:</span>
                        <span class="px-2 py-1 bg-green-600 text-white text-xs rounded font-semibold flex items-center gap-1">
                            <i data-lucide="check" class="w-2 h-2"></i>
                            –ê–∫—Ç–∏–≤–µ–Ω
                        </span>
                    </div>
                    
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-200">
                        <span class="text-gray-900 text-sm font-medium">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥:</span>
                        <span class="text-gray-900 text-xs font-semibold">{{ user.last_login|date:"d.m.Y H:i"|default:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ" }}</span>
                    </div>
                    
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-200">
                        <span class="text-gray-900 text-sm font-medium">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</span>
                        <span class="text-gray-900 text-xs font-semibold">{{ user.date_joined|date:"d.m.Y" }}</span>
                    </div>
                </div>
            </div>

            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="bg-white rounded-xl shadow-sm p-5 border border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <div class="w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center">
                        <i data-lucide="zap" class="w-4 h-4 text-white"></i>
                    </div>
                    –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                </h2>
                
                <div class="space-y-2">
                    <a href="{% url 'crm_my_requests' %}" 
                       class="group w-full flex items-center gap-3 p-3 text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200 border border-transparent hover:border-gray-300">
                        <div class="w-10 h-10 bg-gray-100 group-hover:bg-gray-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                            <i data-lucide="list-checks" class="w-4 h-4 text-gray-700"></i>
                        </div>
                        <div class="flex-1">
                            <div class="font-medium text-sm">–ú–æ–∏ –∑–∞—è–≤–∫–∏</div>
                            <div class="text-xs text-gray-500">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</div>
                        </div>
                        <i data-lucide="chevron-right" class="w-3 h-3 text-gray-400 group-hover:text-gray-600 transition-colors"></i>
                    </a>
                    
                    <a href="{% url 'crm_clients' %}" 
                       class="group w-full flex items-center gap-3 p-3 text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200 border border-transparent hover:border-gray-300">
                        <div class="w-10 h-10 bg-gray-100 group-hover:bg-gray-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                            <i data-lucide="users" class="w-4 h-4 text-gray-700"></i>
                        </div>
                        <div class="flex-1">
                            <div class="font-medium text-sm">–ö–ª–∏–µ–Ω—Ç—ã</div>
                            <div class="text-xs text-gray-500">–ë–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
                        </div>
                        <i data-lucide="chevron-right" class="w-3 h-3 text-gray-400 group-hover:text-gray-600 transition-colors"></i>
                    </a>
                    
                    {% if profile.role == 'owner' %}
                    <a href="{% url 'crm_managers_list' %}" 
                       class="group w-full flex items-center gap-3 p-3 text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200 border border-transparent hover:border-gray-300">
                        <div class="w-10 h-10 bg-gray-100 group-hover:bg-gray-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                            <i data-lucide="settings" class="w-4 h-4 text-gray-700"></i>
                        </div>
                        <div class="flex-1">
                            <div class="font-medium text-sm">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
                            <div class="text-xs text-gray-500">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                        </div>
                        <i data-lucide="chevron-right" class="w-3 h-3 text-gray-400 group-hover:text-gray-600 transition-colors"></i>
                    </a>
                    {% endif %}
                    
                    <a href="{% url 'logout' %}" 
                       class="group w-full flex items-center gap-3 p-3 text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200 border border-transparent hover:border-gray-300">
                        <div class="w-10 h-10 bg-gray-100 group-hover:bg-gray-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                            <i data-lucide="log-out" class="w-4 h-4 text-gray-700"></i>
                        </div>
                        <div class="flex-1">
                            <div class="font-medium text-sm">–í—ã–π—Ç–∏</div>
                            <div class="text-xs text-gray-500">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å</div>
                        </div>
                        <i data-lucide="chevron-right" class="w-3 h-3 text-gray-400 group-hover:text-gray-600 transition-colors"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
<div id="passwordModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden transition-opacity duration-300">
    <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-lg border border-gray-300 transform transition-all duration-300 scale-95 opacity-0" id="passwordModalContent">
        <div class="text-center mb-4">
            <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3">
                <i data-lucide="key" class="w-6 h-6 text-white"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900">–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h3>
            <p class="text-gray-600 text-sm mt-1">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</p>
        </div>
        
        <form method="POST" action="{% url 'crm_change_password' %}" class="space-y-4">
            {% csrf_token %}
            
            <div class="space-y-2">
                <label for="current_password" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                    <i data-lucide="lock" class="w-3 h-3 text-gray-500"></i>
                    –¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å
                </label>
                <input type="password" id="current_password" name="current_password" required
                       class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="space-y-2">
                <label for="new_password" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                    <i data-lucide="lock" class="w-3 h-3 text-gray-500"></i>
                    –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
                </label>
                <input type="password" id="new_password" name="new_password" required
                       class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="space-y-2">
                <label for="confirm_password" class="block text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
                    <i data-lucide="lock" class="w-3 h-3 text-gray-500"></i>
                    –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å
                </label>
                <input type="password" id="confirm_password" name="confirm_password" required
                       class="w-full px-3 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>

            <div class="flex gap-2 pt-3">
                <button type="submit" 
                        class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2.5 rounded-lg font-semibold flex items-center justify-center gap-2 transition-all duration-200">
                    <i data-lucide="check" class="w-3 h-3"></i>
                    –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                </button>
                
                <button type="button" onclick="hidePasswordModal()"
                        class="flex-1 border border-gray-300 text-gray-700 hover:bg-gray-50 px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 flex items-center justify-center gap-2">
                    <i data-lucide="x" class="w-3 h-3"></i>
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function showPasswordModal() {
        const modal = document.getElementById('passwordModal');
        const content = document.getElementById('passwordModalContent');
        modal.classList.remove('hidden');
        setTimeout(() => {
            content.style.opacity = '1';
            content.style.transform = 'scale(1)';
        }, 50);
    }

    function hidePasswordModal() {
        const modal = document.getElementById('passwordModal');
        const content = document.getElementById('passwordModalContent');
        content.style.opacity = '0';
        content.style.transform = 'scale(0.95)';
        setTimeout(() => {
            modal.classList.add('hidden');
        }, 300);
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
    document.getElementById('passwordModal').addEventListener('click', function(e) {
        if (e.target === this) {
            hidePasswordModal();
        }
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∫–æ–Ω–æ–∫
    document.addEventListener('DOMContentLoaded', function() {
        lucide.createIcons();
    });
</script>
{% endblock %}